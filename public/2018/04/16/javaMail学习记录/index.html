<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javaMail学习记录 · 陈昀钊</title><meta name="description" content="javaMail学习记录 - 陈昀钊"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yzchen.com/atom.xml" title="陈昀钊"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://www.uestc.edu.cn/" target="_blank" class="nav-list-link">UNIVERSITY</a></li><li class="nav-list-item"><a href="https://github.com/cyzuestc" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="http://bbs.uestc.edu.cn/" target="_blank" class="nav-list-link">清水河畔</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">javaMail学习记录</h1><div class="post-info">Apr 16, 2018</div><div class="post-content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这段时间需要实时给自己发送消息,思来想去最方便快捷的还是邮件. 所以搜了很多教程, 填了很多坑. 在搞完这些之际,特回头来总结一下.<br>其中, 关键的步骤为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Properties prop = new Properties;</span><br><span class="line">Session session = javax.mail.Session.getInstance(prop);</span><br><span class="line">Transport ts = session.getTransport();</span><br><span class="line">Message msg = createSimpleMail(session);</span><br><span class="line">ts.sendMessage(msg,msg.getAllRecipients);</span><br></pre></td></tr></table></figure></p>
<h1 id="设置邮件properties-和session"><a href="#设置邮件properties-和session" class="headerlink" title="设置邮件properties 和session"></a>设置邮件properties 和session</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public void sendMail()&#123;</span><br><span class="line">	//new 一个properties</span><br><span class="line">	Properties prop = new Properties();</span><br><span class="line">	prop.put(&quot;mail.host&quot;,&quot;smtp.qq.com&quot;);</span><br><span class="line">	prop.put(&quot;mail.transport.protocol&quot;,&quot;smtp&quot;);</span><br><span class="line">	prop.put(&quot;mail.smtp.auth&quot;,true);</span><br><span class="line">	//此行缺失会导致qq邮箱无法发送,但163可以发送</span><br><span class="line">	prop.put(&quot;mail.smtp.starttls.enable&quot;,&quot;true&quot;);</span><br><span class="line">	Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider);</span><br><span class="line">	</span><br><span class="line">	//获取session</span><br><span class="line">	Session session = javax.mail.Session.getInstance(prop);</span><br><span class="line">	session.setDebug(true);</span><br><span class="line">	</span><br><span class="line">	//获取transport</span><br><span class="line">	Transport ts = session.getTransport();</span><br><span class="line">	ts.connect(user,pass);</span><br><span class="line">	</span><br><span class="line">	//获取Message</span><br><span class="line">	Message msg = createSimpleMail(session);</span><br><span class="line">	</span><br><span class="line">	//发送</span><br><span class="line">	ts.sendMessage(msg,msg.getAllRecipients);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="MimeMessage-构建邮件体"><a href="#MimeMessage-构建邮件体" class="headerlink" title="MimeMessage :构建邮件体"></a>MimeMessage :构建邮件体</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public static MimeMessage createSimpleMail(Session session) throw AddressException,MessagingException&#123;</span><br><span class="line">	MimeMessage mm = new MimeMessage(session);</span><br><span class="line">	//设置发件人</span><br><span class="line">	mm.setFrom(new InternetAddress(&quot;from@qq.com&quot;));</span><br><span class="line">	//设置收件人</span><br><span class="line">	mm.setRecipient(Message.RecipientType.TO,new InternetAddress(&quot;to@qq.com&quot;));</span><br><span class="line">	//设置抄送人</span><br><span class="line">	mm.setRecipient(Message.RecipientType.CC, new InternetAddress(&quot;用户名@163.com&quot;));</span><br><span class="line">	//设置题目和内容</span><br><span class="line">	mm.setSubject(mail_title);</span><br><span class="line">    mm.setContent(mail_content, &quot;text/html;charset=gbk&quot;);</span><br><span class="line">	</span><br><span class="line">	return mm;</span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/2018/04/16/linux后台运行方法学习/" class="prev">PREV</a><a href="/2018/04/08/TCP-IP模型各层功能简介/" class="next">NEXT</a></div><div class="copyright"><p>© 2018 powered by <a href="https://github.com/cyzuestc" target="_blank">Chenyunzhao</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>