---
title: 2017.9.18 斗地主记牌器思路
date: 2017-9-18 07:55:58
tags:
---
前两日玩欢乐斗地主,豆子输得精光, 不叹牌面差,就怕牌技差, 很多时候就算赢面也能给打输.所以就想写一个记牌器的辅助工具,知道剩余的牌, 稍微能好一些吧.
于是用按键精灵手机助手,搞了24个小时,回想起来真的是各种坑...
---
整体思路:
1. 玩家和上下家的首牌位置固定, 每张牌的宽度固定,所以可以精确到每张牌位置取图取数.
2. 建立剩余牌的数组,在屏幕前端实时showMessage
3. 开局抢地主前识别玩家手牌,开局后检测上下家出的牌,用两个字符串代表上次的牌与这次的牌,如果不相同说明玩家刚刚出了牌,就记录到数组中,如果相同或者等于空,说明检测到的还是之前的牌,或者还没出牌,就不做变动.
4.程序的bug在于, 上次检测到AA,这次只检测到A,就会重复计算A,A的剩余个数出现负值.改进方法是:
-   将玩家的出牌记录下来,如果重复计算就可以看得到
-   提高数字识别率

最后的结果: 总会错一两个牌的剩余个数,但总体可以使用.

---

